CREATE TABLE "BILLING"."INVOICE_ATTACHMENTS" 
   (	"ID" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE  NOT NULL ENABLE, 
	"INVOICE_ID" NUMBER NOT NULL ENABLE, 
	"FILENAME" VARCHAR2(255 BYTE) NOT NULL ENABLE, 
	"DESCRIPTION" VARCHAR2(255 BYTE) NOT NULL ENABLE, 
	"MIME_TYPE" VARCHAR2(255 BYTE) NOT NULL ENABLE, 
	"BLOB_CONTENT" BLOB, 
	"BLOB_UPDATED" DATE NOT NULL ENABLE, 
	"ROW_VERSION" NUMBER(*,0) NOT NULL ENABLE, 
	"CREATED" DATE NOT NULL ENABLE, 
	"CREATED_BY" VARCHAR2(255 CHAR) NOT NULL ENABLE, 
	"UPDATED" DATE NOT NULL ENABLE, 
	"UPDATED_BY" VARCHAR2(255 CHAR) NOT NULL ENABLE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "APEX_7944359602492022" 
 LOB ("BLOB_CONTENT") STORE AS SECUREFILE (
  TABLESPACE "APEX_7944359602492022" ENABLE STORAGE IN ROW 4000 CHUNK 8192
  NOCACHE LOGGING  NOCOMPRESS  KEEP_DUPLICATES 
  STORAGE(INITIAL 262144 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)) ;
ALTER TABLE "BILLING"."INVOICE_ATTACHMENTS" ADD CONSTRAINT "INVOICE_ATTACHMENTS_ID_PK" PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "APEX_7944359602492022"  ENABLE;
ALTER TABLE "BILLING"."INVOICE_ATTACHMENTS" ADD CONSTRAINT "INVOICE_ATTACHMENTS_INVOICE_ID_FK" FOREIGN KEY ("INVOICE_ID")
	  REFERENCES "BILLING"."INVOICES" ("ID") ENABLE;

  CREATE OR REPLACE EDITIONABLE TRIGGER "BILLING"."INVOICE_ATTACHMENTS_BIU" before
            insert or

update on invoice_attachments for each row
            begin

if inserting then
                    :new.row_version := 1;

elsif updating then
                    :new.row_version :=
nvl(:old.row_version, 0) + 1;
                end if;

                if
inserting then
                    :new.created := sysdate;

:new.created_by := coalesce(sys_context('apex$session', 'app_user'), user);

end if;

                :new.updated := sysdate;

:new.updated_by := coalesce(sys_context('apex$session', 'app_user'), user);

end invoice_attachments_biu;
/
ALTER TRIGGER "BILLING"."INVOICE_ATTACHMENTS_BIU" ENABLE;